---
author: "Serhii Polishchuk"
title: "Запуск php скрипта по cron в Ubuntu 10.10"
date: 2011-04-15
tags: ["Ubuntu"]
draft: true
---
<!--more-->
<p>Задача состоит в том чтобы с определенной периодичностью запускать <strong>php </strong>файл. В данном случае скрипт <strong>обновления цен в интернет магазине</strong>. Цены и наличие товара в моем магазине должны обновляться каждый час во избежание всяческих недоразумений когда товар на сайте есть, а в наличии у поставщика нет еще со вчера, или цена изменилась и пр. <!--more--> Несколько слов о <strong>cron</strong> <strong>cron</strong> &mdash; демон-планировщик задач в <strong>UNIX</strong>-подобных операционных системах, использующийся для периодического выполнения заданий в заданное время. Утилита cron выполняет команды в заданное время. Регулярные действия описываются инструкциями, помещенными в файлы <strong>crontab</strong>, которые находятся в каталоге. Как видим ключевое здесь&nbsp;<strong>crontab </strong>именно в этом файле хранятся инструкции по заданиям которые нужно выполнить. Открываем терминал, прописываем:</p>

<pre>
<code class="bash">crontab -e</code></pre>

<p>Тем самым откроем в редакторе по умолчанию файл <strong>crontab </strong>для редактирования. У меня это <strong>Vim</strong>. Поэтому нажимаю &quot;i&quot; для редактирования в конце файла добавляю строчку:</p>

<pre>
<code class="no-highlight">1 * * * * /usr/bin/php5 /var/www/myscript.php</code></pre>

<p>Вместо /var/www/myscript.php полный путь к Вашему скрипту. Выхожу из редактирования в Vim с помощью Esc, сохраняю ZZ Для того чтобы проверить записались ли изменения в файл, в терминале набираю:</p>

<pre>
<code class="bash">crontab -l</code></pre>

<p>Каждая строка в файле <strong>crontab </strong>является исполняемой, для того чтобы задать инструкцию нужно указать 6 полей: минута час день_месяца месяц день_недели команда Допустимые значения:</p>

<ol>
	<li>минута от 0 до 59</li>
	<li>час от 0 до 23</li>
	<li>день_месяца от 1 до 31</li>
	<li>месяц от 1 до 12 (можно три буквы из названия месяца, регистр не имеет значения от jan до dec)</li>
	<li>день_недели от 0 до 6 (0 это воскресенье, можно писать от sun до sat)</li>
</ol>

<p><strong>Дополнение 1.</strong> В скрипт не хотел выполнятся по крону, несмотря на успешный запуск в браузере. Проблема оказалась в неполном пути к файлу. Если у Вас есть какие либо пути к файлам, позаботьтесь о том чтобы пути были полными.</p>

<p><strong>Дополнение 2.</strong> У меня на связке Ubuntu Server + LAMP отказался запускаться скрипт через&nbsp;командную&nbsp;строку из-за отсутствия файла&nbsp;<span>/usr/bin/php5. Решением проблемы стало:</span>&nbsp;</p>

<pre>
<code class="bash">sudo apt-get install php5-cli </code></pre>

<p><strong>Дополнение 3.</strong> Отказался работать Image Magick через командную строку. Помогло это:&nbsp;</p>

<pre>
<code class="bash">sudo apt-get install php5-imagick</code></pre>

<p>Большое спасибо <strong><a href="http://forum.ubuntu.ru/index.php?action=profile;u=19089">scream4ik</a></strong> с <a href="http://forum.ubuntu.ru">руcскоязычного форума Ubuntu</a></p>
